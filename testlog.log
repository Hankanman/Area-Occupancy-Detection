============================= test session starts ==============================
platform linux -- Python 3.13.5, pytest-8.4.0, pluggy-1.6.0 -- /workspaces/Area-Occupancy-Detection/.venv/bin/python
cachedir: .pytest_cache
rootdir: /workspaces/Area-Occupancy-Detection
configfile: pyproject.toml
plugins: requests-mock-1.12.1, picked-0.5.1, pytest_freezer-0.4.9, github-actions-annotate-failures-0.3.0, unordered-0.7.0, syrupy-4.9.1, aiohttp-1.1.0, cov-6.1.1, socket-0.7.0, xdist-3.7.0, respx-0.22.0, sugar-1.0.0, asyncio-1.0.0, timeout-2.4.0, anyio-4.9.0, homeassistant-custom-component-0.13.263
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... collected 425 items

tests/test_binary_sensor.py::TestOccupancy::test_initialization[True] PASSED [  0%]
tests/test_binary_sensor.py::TestOccupancy::test_async_added_to_hass[True] PASSED [  0%]
tests/test_binary_sensor.py::TestOccupancy::test_async_will_remove_from_hass[True] PASSED [  0%]
tests/test_binary_sensor.py::TestOccupancy::test_icon_property[True] PASSED [  0%]
tests/test_binary_sensor.py::TestOccupancy::test_is_on_property[True] PASSED [  1%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_initialization[True] PASSED [  1%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_async_added_to_hass[True] PASSED [  1%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_restore_previous_state_no_data[True] PASSED [  1%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_restore_previous_state_with_data[True] PASSED [  2%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_async_will_remove_from_hass[True] PASSED [  2%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_extra_state_attributes[True] PASSED [  2%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_weight_property[True] PASSED [  2%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_get_valid_entities[True] PASSED [  3%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_initialize_from_current_states[True] PASSED [  3%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_handle_state_change_door_opening[True] PASSED [  3%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_handle_state_change_motion_detected[True] PASSED [  3%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_process_door_state_opening_when_occupied[True] PASSED [  4%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_process_door_state_closing_with_recent_motion[True] PASSED [  4%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_process_motion_state_detected[True] PASSED [  4%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_set_state_to_occupied[True] PASSED [  4%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_set_state_to_unoccupied[True] PASSED [  4%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_start_max_duration_timer[True] PASSED [  5%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_cancel_max_duration_timer[True] PASSED [  5%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_handle_max_duration_timeout[True] PASSED [  5%]
tests/test_binary_sensor.py::TestWaspInBoxSensor::test_reset_after_max_duration[True] PASSED [  5%]
tests/test_binary_sensor.py::TestAsyncSetupEntry::test_async_setup_entry_with_wasp_enabled[True] PASSED [  6%]
tests/test_binary_sensor.py::TestAsyncSetupEntry::test_async_setup_entry_with_wasp_disabled[True] PASSED [  6%]
tests/test_binary_sensor.py::TestWaspInBoxIntegration::test_complete_wasp_occupancy_cycle[True] PASSED [  6%]
tests/test_binary_sensor.py::TestWaspInBoxIntegration::test_wasp_timeout_scenarios[True] PASSED [  6%]
tests/test_binary_sensor.py::TestWaspInBoxIntegration::test_wasp_state_persistence[True] PASSED [  7%]
tests/test_binary_sensor.py::TestWaspInBoxIntegration::test_error_handling_during_state_changes[True] PASSED [  7%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_valid[True] PASSED [  7%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_no_motion_sensors[True] PASSED [  7%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_invalid_weight[True] PASSED [  8%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_primary_not_in_motion[True] PASSED [  8%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_invalid_probability[True] PASSED [  8%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_invalid_decay_timeout[True] PASSED [  8%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_invalid_update_interval[True] PASSED [  8%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_invalid_threshold_low[True] PASSED [  9%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_invalid_threshold_high[True] PASSED [  9%]
tests/test_config_flow.py::TestBaseOccupancyFlow::test_validate_config_empty_name[True] PASSED [  9%]
tests/test_config_flow.py::TestHelperFunctions::test_get_state_select_options PASSED [  9%]
tests/test_config_flow.py::TestHelperFunctions::test_get_include_entities PASSED [ 10%]
tests/test_config_flow.py::TestHelperFunctions::test_create_schema_defaults PASSED [ 10%]
tests/test_config_flow.py::TestHelperFunctions::test_create_schema_with_defaults PASSED [ 10%]
tests/test_config_flow.py::TestHelperFunctions::test_create_schema_options_mode PASSED [ 10%]
tests/test_config_flow.py::TestAreaOccupancyConfigFlow::test_initialization PASSED [ 11%]
tests/test_config_flow.py::TestAreaOccupancyConfigFlow::test_async_step_user_no_input PASSED [ 11%]
tests/test_config_flow.py::TestAreaOccupancyConfigFlow::test_async_step_user_with_valid_input PASSED [ 11%]
tests/test_config_flow.py::TestAreaOccupancyConfigFlow::test_async_step_user_with_invalid_input PASSED [ 11%]
tests/test_config_flow.py::TestConfigFlowIntegration::test_complete_config_flow PASSED [ 12%]
tests/test_config_flow.py::TestConfigFlowIntegration::test_complete_options_flow PASSED [ 12%]
tests/test_config_flow.py::TestConfigFlowIntegration::test_options_flow_adds_name_for_validation PASSED [ 12%]
tests/test_config_flow.py::TestConfigFlowIntegration::test_config_flow_with_existing_entry PASSED [ 12%]
tests/test_config_flow.py::TestConfigFlowIntegration::test_error_recovery_in_config_flow PASSED [ 12%]
tests/test_config_flow.py::TestConfigFlowIntegration::test_schema_generation_with_entities PASSED [ 13%]
tests/test_config_flow.py::TestConfigFlowIntegration::test_state_options_generation PASSED [ 13%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_initialization PASSED [ 13%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_device_info_property PASSED [ 13%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_probability_property PASSED [ 14%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_prior_property PASSED [ 14%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_decay_property PASSED [ 14%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_is_occupied_property PASSED [ 14%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_threshold_property PASSED [ 15%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_binary_sensor_entity_ids_property PASSED [ 15%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_decaying_entities_property PASSED [ 15%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_async_setup_basic PASSED [ 15%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_async_shutdown PASSED [ 16%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_async_update_options PASSED [ 16%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_update_method PASSED [ 16%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_track_entity_state_changes PASSED [ 16%]
tests/test_coordinator.py::TestAreaOccupancyCoordinator::test_real_device_info_constants PASSED [ 16%]
tests/test_coordinator.py::TestCoordinatorTimerMethods::test_handle_decay_timer_decay_enabled PASSED [ 17%]
tests/test_coordinator.py::TestCoordinatorTimerMethods::test_handle_decay_timer_decay_disabled PASSED [ 17%]
tests/test_coordinator.py::TestCoordinatorTimerMethods::test_start_decay_timer_success PASSED [ 17%]
tests/test_coordinator.py::TestCoordinatorTimerMethods::test_start_decay_timer_already_exists PASSED [ 17%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_probability_with_empty_entities PASSED [ 18%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_probability_with_active_entities PASSED [ 18%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_probability_with_decaying_entities PASSED [ 18%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_prior_with_empty_entities PASSED [ 18%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_prior_with_multiple_entities PASSED [ 19%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_decay_with_empty_entities PASSED [ 19%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_decay_with_mixed_entities PASSED [ 19%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_occupied_threshold_comparison PASSED [ 19%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_threshold_from_config PASSED [ 20%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_threshold_fallback_no_config PASSED [ 20%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_binary_sensor_entity_ids_structure PASSED [ 20%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_binary_sensor_entity_ids_with_values PASSED [ 20%]
tests/test_coordinator.py::TestCoordinatorPropertyCalculations::test_decaying_entities_filtering PASSED [ 20%]
tests/test_coordinator.py::TestCoordinatorIntegrationUsingCentralizedMocks::test_full_coordinator_lifecycle_with_centralized_mocks PASSED [ 21%]
tests/test_coordinator.py::TestCoordinatorIntegrationUsingCentralizedMocks::test_update_method_data_structure PASSED [ 21%]
tests/test_coordinator.py::TestCoordinatorIntegrationUsingCentralizedMocks::test_state_tracking_with_empty_entities PASSED [ 21%]
tests/test_coordinator.py::TestCoordinatorIntegrationUsingCentralizedMocks::test_state_tracking_with_multiple_entities PASSED [ 21%]
tests/test_coordinator.py::TestCoordinatorIntegrationUsingCentralizedMocks::test_threshold_boundary_conditions_comprehensive PASSED [ 22%]
tests/test_coordinator.py::TestCoordinatorIntegrationUsingCentralizedMocks::test_configuration_updates_with_centralized_mocks PASSED [ 22%]
tests/test_coordinator.py::TestCoordinatorIntegrationUsingCentralizedMocks::test_device_info_comprehensive PASSED [ 22%]
tests/test_coordinator.py::TestCoordinatorErrorHandlingUsingCentralizedMocks::test_setup_error_handling PASSED [ 22%]
tests/test_coordinator.py::TestCoordinatorErrorHandlingUsingCentralizedMocks::test_update_error_handling PASSED [ 23%]
tests/test_coordinator.py::TestCoordinatorErrorHandlingUsingCentralizedMocks::test_option_update_error_handling PASSED [ 23%]
tests/test_coordinator.py::TestCoordinatorErrorHandlingUsingCentralizedMocks::test_state_tracking_error_handling PASSED [ 23%]
tests/test_coordinator.py::TestCoordinatorErrorHandlingUsingCentralizedMocks::test_shutdown_error_handling PASSED [ 23%]
tests/test_coordinator.py::TestCoordinatorEdgeCasesUsingCentralizedMocks::test_initialization_with_realistic_config PASSED [ 24%]
tests/test_coordinator.py::TestCoordinatorEdgeCasesUsingCentralizedMocks::test_probability_edge_values PASSED [ 24%]
tests/test_coordinator.py::TestCoordinatorEdgeCasesUsingCentralizedMocks::test_threshold_edge_values PASSED [ 24%]
tests/test_coordinator.py::TestCoordinatorEdgeCasesUsingCentralizedMocks::test_prior_edge_values PASSED [ 24%]
tests/test_coordinator.py::TestCoordinatorEdgeCasesUsingCentralizedMocks::test_decay_edge_values PASSED [ 24%]
tests/test_coordinator.py::TestCoordinatorEdgeCasesUsingCentralizedMocks::test_empty_entity_list_tracking PASSED [ 25%]
tests/test_coordinator.py::TestCoordinatorEdgeCasesUsingCentralizedMocks::test_binary_sensor_entity_ids_none_values PASSED [ 25%]
tests/test_coordinator.py::TestCoordinatorAdvancedTimerManagement::test_timer_lifecycle_full_cycle PASSED [ 25%]
tests/test_coordinator.py::TestCoordinatorAdvancedTimerManagement::test_timer_start_with_missing_hass PASSED [ 25%]
tests/test_coordinator.py::TestCoordinatorAdvancedTimerManagement::test_timer_error_handling_during_callbacks PASSED [ 26%]
tests/test_coordinator.py::TestCoordinatorSetupScenarios::test_setup_with_no_stored_data PASSED [ 26%]
tests/test_coordinator.py::TestCoordinatorSetupScenarios::test_setup_with_stored_data_restoration PASSED [ 26%]
tests/test_coordinator.py::TestCoordinatorSetupScenarios::test_setup_entity_initialization_failure PASSED [ 26%]
tests/test_coordinator.py::TestCoordinatorSetupScenarios::test_setup_storage_failure_recovery PASSED [ 27%]
tests/test_coordinator.py::TestCoordinatorSetupScenarios::test_setup_partial_failure_recovery PASSED [ 27%]
tests/test_coordinator.py::TestCoordinatorProbabilityCalculationEdgeCases::test_probability_with_mixed_evidence_and_decay PASSED [ 27%]
tests/test_coordinator.py::TestCoordinatorProbabilityCalculationEdgeCases::test_probability_calculation_with_varying_weights PASSED [ 27%]
tests/test_coordinator.py::TestCoordinatorProbabilityCalculationEdgeCases::test_prior_calculation_with_heterogeneous_entities PASSED [ 28%]
tests/test_coordinator.py::TestCoordinatorProbabilityCalculationEdgeCases::test_decay_calculation_with_mixed_states PASSED [ 28%]
tests/test_coordinator.py::TestCoordinatorResourceManagement::test_shutdown_behavior_with_real_coordinator PASSED [ 28%]
tests/test_coordinator.py::TestCoordinatorResourceManagement::test_shutdown_with_none_resources PASSED [ 28%]
tests/test_coordinator.py::TestCoordinatorIntegrationFlows::test_full_coordinator_lifecycle_with_realistic_data PASSED [ 28%]
tests/test_coordinator.py::TestCoordinatorPerformanceScenarios::test_probability_calculation_with_many_entities PASSED [ 29%]
tests/test_coordinator.py::TestCoordinatorPerformanceScenarios::test_prior_calculation_with_many_entities PASSED [ 29%]
tests/test_coordinator.py::TestCoordinatorPerformanceScenarios::test_state_tracking_with_many_entities PASSED [ 29%]
tests/test_coordinator.py::TestCoordinatorDeviceInfoAndProperties::test_device_info_with_missing_config PASSED [ 29%]
tests/test_coordinator.py::TestCoordinatorDeviceInfoAndProperties::test_binary_sensor_entity_ids_with_values PASSED [ 30%]
tests/test_coordinator.py::TestCoordinatorDeviceInfoAndProperties::test_decaying_entities_filtering_complex PASSED [ 30%]
tests/test_coordinator.py::TestCoordinatorErrorRecoveryAndResilience::test_setup_partial_failure_recovery PASSED [ 30%]
tests/test_coordinator.py::TestCoordinatorErrorRecoveryAndResilience::test_update_method_structure PASSED [ 30%]
tests/test_coordinator.py::TestCoordinatorErrorRecoveryAndResilience::test_state_tracking_method_structure PASSED [ 31%]
tests/test_data_config.py::TestSensors::test_initialization_defaults PASSED [ 31%]
tests/test_data_config.py::TestSensors::test_initialization_with_values PASSED [ 31%]
tests/test_data_config.py::TestSensors::test_get_motion_sensors_without_wasp PASSED [ 31%]
tests/test_data_config.py::TestSensors::test_get_motion_sensors_with_wasp_enabled PASSED [ 32%]
tests/test_data_config.py::TestSensors::test_get_motion_sensors_with_wasp_enabled_no_entity PASSED [ 32%]
tests/test_data_config.py::TestSensorStates::test_initialization_defaults PASSED [ 32%]
tests/test_data_config.py::TestSensorStates::test_initialization_with_values PASSED [ 32%]
tests/test_data_config.py::TestWeights::test_initialization_defaults PASSED [ 32%]
tests/test_data_config.py::TestWeights::test_initialization_with_values PASSED [ 33%]
tests/test_data_config.py::TestDecay::test_initialization_defaults PASSED [ 33%]
tests/test_data_config.py::TestDecay::test_initialization_with_values PASSED [ 33%]
tests/test_data_config.py::TestConfig::test_initialization_defaults PASSED [ 33%]
tests/test_data_config.py::TestConfig::test_initialization_with_values PASSED [ 34%]
tests/test_data_config.py::TestConfig::test_start_time_property PASSED   [ 34%]
tests/test_data_config.py::TestConfig::test_end_time_property PASSED     [ 34%]
tests/test_data_config.py::TestConfig::test_from_dict_minimal PASSED     [ 34%]
tests/test_data_config.py::TestConfig::test_from_dict_comprehensive PASSED [ 35%]
tests/test_data_config.py::TestConfig::test_from_dict_with_invalid_weights PASSED [ 35%]
tests/test_data_config.py::TestConfig::test_get_method PASSED            [ 35%]
tests/test_data_config.py::TestConfig::test_update_config PASSED         [ 35%]
tests/test_data_config.py::TestConfigIntegration::test_config_manager_full_lifecycle PASSED [ 36%]
tests/test_data_decay.py::TestDecay::test_initialization PASSED          [ 36%]
tests/test_data_decay.py::TestDecay::test_initialization_with_validation PASSED [ 36%]
tests/test_data_decay.py::TestDecay::test_to_dict PASSED                 [ 36%]
tests/test_data_decay.py::TestDecay::test_from_dict PASSED               [ 36%]
tests/test_data_decay.py::TestDecay::test_decay_factor_not_decaying PASSED [ 37%]
tests/test_data_decay.py::TestDecay::test_decay_factor_decaying PASSED   [ 37%]
tests/test_data_decay.py::TestDecay::test_decay_factor_auto_stop PASSED  [ 37%]
tests/test_data_entity.py::TestEntity::test_initialization PASSED        [ 37%]
tests/test_data_entity.py::TestEntity::test_to_dict PASSED               [ 38%]
tests/test_data_entity.py::TestEntity::test_from_dict PASSED             [ 38%]
tests/test_data_entity.py::TestEntityManager::test_initialization PASSED [ 38%]
tests/test_data_entity.py::TestEntityManager::test_entities_property PASSED [ 38%]
tests/test_data_entity.py::TestEntityManager::test_entity_ids_property PASSED [ 39%]
tests/test_data_entity.py::TestEntityManager::test_active_entities_property PASSED [ 39%]
tests/test_data_entity.py::TestEntityManager::test_inactive_entities_property PASSED [ 39%]
tests/test_data_entity.py::TestEntityManager::test_to_dict PASSED        [ 39%]
tests/test_data_entity.py::TestEntityManager::test_from_dict PASSED      [ 40%]
tests/test_data_entity.py::TestEntityManager::test_get_entity PASSED     [ 40%]
tests/test_data_entity.py::TestEntityManager::test_add_entity PASSED     [ 40%]
tests/test_data_entity.py::TestEntityManager::test_remove_entity PASSED  [ 40%]
tests/test_data_entity.py::TestEntityPropertiesAndMethods::test_state_property_edge_cases PASSED [ 40%]
tests/test_data_entity.py::TestEntityPropertiesAndMethods::test_available_property PASSED [ 41%]
tests/test_data_entity.py::TestEntityPropertiesAndMethods::test_evidence_with_active_range PASSED [ 41%]
tests/test_data_entity.py::TestEntityPropertiesAndMethods::test_has_new_evidence_transitions PASSED [ 41%]
tests/test_data_entity.py::TestEntityPropertiesAndMethods::test_probability_with_decay PASSED [ 41%]
tests/test_data_entity.py::TestEntityPropertiesAndMethods::test_effective_probability_property PASSED [ 42%]
tests/test_data_entity.py::TestEntityManagerAdvanced::test_decaying_entities_property PASSED [ 42%]
tests/test_data_entity.py::TestEntityManagerAdvanced::test_from_dict_error_cases PASSED [ 42%]
tests/test_data_entity.py::TestEntityFactory::test_initialization PASSED [ 42%]
tests/test_data_entity.py::TestEntityFactory::test_create_from_config_spec PASSED [ 43%]
tests/test_data_entity.py::TestEntityFactory::test_create_all_from_config PASSED [ 43%]
tests/test_data_entity.py::TestEntityFactory::test_create_entity_without_stored_data PASSED [ 43%]
tests/test_data_entity_type.py::TestInputType::test_input_type_values PASSED [ 43%]
tests/test_data_entity_type.py::TestEntityType::test_initialization_with_states PASSED [ 44%]
tests/test_data_entity_type.py::TestEntityType::test_initialization_with_range PASSED [ 44%]
tests/test_data_entity_type.py::TestEntityType::test_initialization_validation PASSED [ 44%]
tests/test_data_entity_type.py::TestEntityType::test_initialization_errors PASSED [ 44%]
tests/test_data_entity_type.py::TestEntityType::test_has_evidence_with_states PASSED [ 44%]
tests/test_data_entity_type.py::TestEntityType::test_has_evidence_with_range PASSED [ 45%]
tests/test_data_entity_type.py::TestEntityType::test_to_dict PASSED      [ 45%]
tests/test_data_entity_type.py::TestEntityType::test_from_dict PASSED    [ 45%]
tests/test_data_entity_type.py::TestEntityTypeManager::test_initialization PASSED [ 45%]
tests/test_data_entity_type.py::TestEntityTypeManager::test_async_initialize PASSED [ 46%]
tests/test_data_entity_type.py::TestEntityTypeManager::test_get_entity_type PASSED [ 46%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_apply_weight_valid PASSED [ 46%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_apply_weight_environmental_sensors PASSED [ 46%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_apply_weight_environmental_sensors_no_config PASSED [ 47%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_apply_weight_invalid PASSED [ 47%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_apply_states_valid PASSED [ 47%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_apply_states_invalid PASSED [ 47%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_apply_range_valid PASSED [ 48%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_apply_range_invalid PASSED [ 48%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_to_dict_roundtrip PASSED [ 48%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_from_dict_errors PASSED [ 48%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_cleanup PASSED [ 48%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_build_entity_types_with_environmental_weight PASSED [ 49%]
tests/test_data_entity_type.py::TestEntityTypeManagerOverrides::test_build_entity_types_without_config_uses_defaults PASSED [ 49%]
tests/test_data_prior.py::test_initialization PASSED                     [ 49%]
tests/test_data_prior.py::test_value_property_clamping PASSED            [ 49%]
tests/test_data_prior.py::test_update_occupancy_higher_than_primary PASSED [ 50%]
tests/test_data_prior.py::test_update_handles_exception_and_sets_min_prior PASSED [ 50%]
tests/test_data_prior.py::test_calculate_prior_method PASSED             [ 50%]
tests/test_data_prior.py::test_to_dict_and_from_dict PASSED              [ 50%]
tests/test_data_prior.py::test_prior_factor_constant PASSED              [ 51%]
tests/test_data_purpose.py::TestAreaPurpose::test_area_purpose_values PASSED [ 51%]
tests/test_data_purpose.py::TestPurpose::test_purpose_creation PASSED    [ 51%]
tests/test_data_purpose.py::TestPurpose::test_purpose_to_dict PASSED     [ 51%]
tests/test_data_purpose.py::TestPurpose::test_purpose_from_dict PASSED   [ 52%]
tests/test_data_purpose.py::TestPurposeDefinitions::test_all_purposes_defined PASSED [ 52%]
tests/test_data_purpose.py::TestPurposeDefinitions::test_purpose_half_lives PASSED [ 52%]
tests/test_data_purpose.py::TestPurposeDefinitions::test_get_purpose_options PASSED [ 52%]
tests/test_data_purpose.py::TestPurposeManager::test_initialization PASSED [ 52%]
tests/test_data_purpose.py::TestPurposeManager::test_async_initialize_with_valid_purpose PASSED [ 53%]
tests/test_data_purpose.py::TestPurposeManager::test_async_initialize_with_invalid_purpose PASSED [ 53%]
tests/test_data_purpose.py::TestPurposeManager::test_async_initialize_with_no_purpose PASSED [ 53%]
tests/test_data_purpose.py::TestPurposeManager::test_get_purpose PASSED  [ 53%]
tests/test_data_purpose.py::TestPurposeManager::test_get_all_purposes PASSED [ 54%]
tests/test_data_purpose.py::TestPurposeManager::test_set_purpose PASSED  [ 54%]
tests/test_data_purpose.py::TestPurposeManager::test_cleanup PASSED      [ 54%]
tests/test_db.py::TestDatabaseModels::test_areas_model_creation PASSED   [ 54%]
tests/test_db.py::TestDatabaseModels::test_entities_model_creation PASSED [ 55%]
tests/test_db.py::TestDatabaseModels::test_intervals_model_creation PASSED [ 55%]
tests/test_db.py::TestDatabaseModels::test_priors_model_creation PASSED  [ 55%]
tests/test_db.py::TestDatabaseModels::test_relationships PASSED          [ 55%]
tests/test_db.py::TestDatabaseModels::test_to_dict_methods PASSED        [ 56%]
tests/test_db.py::TestDatabaseModels::test_unique_constraints PASSED     [ 56%]
tests/test_db.py::TestDatabaseOperations::test_area_occupancy_db_initialization PASSED [ 56%]
tests/test_db.py::TestDatabaseOperations::test_session_management PASSED [ 56%]
tests/test_db.py::TestDatabaseOperations::test_seeded_database PASSED    [ 56%]
tests/test_init.py::TestAsyncSetupEntry::test_async_setup_entry_coordinator_init_failure PASSED [ 57%]
tests/test_init.py::TestAsyncSetupEntry::test_async_setup_entry_success PASSED [ 57%]
tests/test_init.py::TestAsyncSetupEntry::test_async_setup_entry_refresh_failure PASSED [ 57%]
tests/test_init.py::TestAsyncSetupEntry::test_async_setup_entry_migration_failure PASSED [ 57%]
tests/test_init.py::TestAsyncSetup::test_async_setup_success PASSED      [ 58%]
tests/test_init.py::TestAsyncReloadEntry::test_async_reload_entry_success PASSED [ 58%]
tests/test_init.py::TestAsyncUnloadEntry::test_async_unload_entry_success PASSED [ 58%]
tests/test_init.py::TestAsyncUnloadEntry::test_async_unload_entry_platform_unload_failure PASSED [ 58%]
tests/test_init.py::TestAsyncUnloadEntry::test_async_unload_entry_no_coordinator PASSED [ 59%]
tests/test_init.py::TestEntryUpdated::test_async_entry_updated_success PASSED [ 59%]
tests/test_init.py::TestEntryUpdated::test_async_entry_updated_no_coordinator PASSED [ 59%]
tests/test_init.py::TestAsyncRemoveEntry::test_remove_entry_with_runtime_data PASSED [ 59%]
tests/test_init.py::TestAsyncRemoveEntry::test_remove_entry_without_runtime_data PASSED [ 60%]
tests/test_init.py::TestAsyncRemoveEntry::test_remove_entry_handles_error PASSED [ 60%]
tests/test_migrations.py::TestAsyncMigrateUniqueIds::test_async_migrate_unique_ids_success PASSED [ 60%]
tests/test_migrations.py::TestAsyncMigrateUniqueIds::test_async_migrate_unique_ids_no_entities PASSED [ 60%]
tests/test_migrations.py::TestAsyncMigrateUniqueIds::test_async_migrate_unique_ids_invalid_platform PASSED [ 60%]
tests/test_migrations.py::TestMigratePrimaryOccupancySensor::test_migrate_primary_occupancy_sensor_needed PASSED [ 61%]
tests/test_migrations.py::TestMigratePrimaryOccupancySensor::test_migrate_primary_occupancy_sensor_already_exists PASSED [ 61%]
tests/test_migrations.py::TestMigratePrimaryOccupancySensor::test_migrate_primary_occupancy_sensor_no_motion_sensors PASSED [ 61%]
tests/test_migrations.py::TestMigratePrimaryOccupancySensor::test_migrate_primary_occupancy_sensor_empty_motion_sensors PASSED [ 61%]
tests/test_migrations.py::TestMigratePurposeField::test_migrate_purpose_field_needed PASSED [ 62%]
tests/test_migrations.py::TestMigratePurposeField::test_migrate_purpose_field_already_exists PASSED [ 62%]
tests/test_migrations.py::TestMigratePurposeField::test_migrate_purpose_field_no_sensors PASSED [ 62%]
tests/test_migrations.py::TestMigratePurposeField::test_migrate_purpose_field_other_sensors PASSED [ 62%]
tests/test_migrations.py::TestMigratePurposeField::test_migrate_purpose_field_empty_sensors PASSED [ 63%]
tests/test_migrations.py::TestMigrateConfig::test_migrate_config_adds_primary_sensor PASSED [ 63%]
tests/test_migrations.py::TestMigrateConfig::test_migrate_config_preserves_existing PASSED [ 63%]
tests/test_migrations.py::TestAsyncMigrateStorage::test_async_migrate_storage_no_data PASSED [ 63%]
tests/test_migrations.py::TestAsyncMigrateStorage::test_async_migrate_storage_error PASSED [ 64%]
tests/test_migrations.py::TestAsyncMigrateEntry::test_async_migrate_entry_v1_0_to_current PASSED [ 64%]
tests/test_migrations.py::TestAsyncMigrateEntry::test_async_migrate_entry_already_current PASSED [ 64%]
tests/test_migrations.py::TestAsyncMigrateEntry::test_async_migrate_entry_future_version PASSED [ 64%]
tests/test_migrations.py::TestAsyncMigrateEntry::test_async_migrate_entry_migration_error PASSED [ 64%]
tests/test_migrations.py::TestAsyncMigrateEntry::test_async_migrate_entry_invalid_threshold PASSED [ 65%]
tests/test_migrations.py::TestValidateThreshold::test_validate_threshold_valid_values PASSED [ 65%]
tests/test_migrations.py::TestValidateThreshold::test_validate_threshold_invalid_low PASSED [ 65%]
tests/test_migrations.py::TestValidateThreshold::test_validate_threshold_invalid_high PASSED [ 65%]
tests/test_migrations.py::TestValidateThreshold::test_validate_threshold_edge_cases PASSED [ 66%]
tests/test_migrations.py::TestMigrationsIntegration::test_complete_migration_workflow PASSED [ 66%]
tests/test_migrations.py::TestMigrationsIntegration::test_config_migration_edge_cases PASSED [ 66%]
tests/test_number.py::TestThreshold::test_initialization PASSED          [ 66%]
tests/test_number.py::TestThreshold::test_entity_properties PASSED       [ 67%]
tests/test_number.py::TestThreshold::test_native_value_property PASSED   [ 67%]
tests/test_number.py::TestThreshold::test_async_set_native_value_valid PASSED [ 67%]
tests/test_number.py::TestThreshold::test_async_set_native_value_edge_cases PASSED [ 67%]
tests/test_number.py::TestThreshold::test_async_set_native_value_invalid_low PASSED [ 68%]
tests/test_number.py::TestThreshold::test_async_set_native_value_invalid_high PASSED [ 68%]
tests/test_number.py::TestThreshold::test_async_set_native_value_coordinator_error PASSED [ 68%]
tests/test_number.py::TestThreshold::test_entity_category PASSED         [ 68%]
tests/test_number.py::TestThreshold::test_available_property PASSED      [ 68%]
tests/test_number.py::TestThreshold::test_device_info_property PASSED    [ 69%]
tests/test_number.py::TestThreshold::test_value_conversion_precision PASSED [ 69%]
tests/test_number.py::TestAsyncSetupEntry::test_async_setup_entry_success PASSED [ 69%]
tests/test_number.py::TestAsyncSetupEntry::test_async_setup_entry_with_coordinator_data PASSED [ 69%]
tests/test_number.py::TestThresholdIntegration::test_threshold_update_workflow PASSED [ 70%]
tests/test_number.py::TestThresholdIntegration::test_multiple_threshold_updates PASSED [ 70%]
tests/test_number.py::TestThresholdIntegration::test_threshold_boundary_validation PASSED [ 70%]
tests/test_number.py::TestThresholdIntegration::test_error_recovery PASSED [ 70%]
tests/test_number.py::TestThresholdIntegration::test_state_consistency PASSED [ 71%]
tests/test_number.py::TestThresholdIntegration::test_concurrent_updates PASSED [ 71%]
tests/test_sensor.py::TestAreaOccupancySensorBase::test_initialization PASSED [ 71%]
tests/test_sensor.py::TestAreaOccupancySensorBase::test_set_enabled_default PASSED [ 71%]
tests/test_sensor.py::TestAreaOccupancySensorBase::test_available_property PASSED [ 72%]
tests/test_sensor.py::TestAreaOccupancySensorBase::test_device_info_property PASSED [ 72%]
tests/test_sensor.py::TestPriorsSensor::test_initialization PASSED       [ 72%]
tests/test_sensor.py::TestPriorsSensor::test_native_value_property PASSED [ 72%]
tests/test_sensor.py::TestProbabilitySensor::test_initialization PASSED  [ 72%]
tests/test_sensor.py::TestProbabilitySensor::test_native_value_property PASSED [ 73%]
tests/test_sensor.py::TestEvidenceSensor::test_initialization PASSED     [ 73%]
tests/test_sensor.py::TestEvidenceSensor::test_native_value_property PASSED [ 73%]
tests/test_sensor.py::TestEvidenceSensor::test_native_value_no_entity_manager PASSED [ 73%]
tests/test_sensor.py::TestEvidenceSensor::test_extra_state_attributes PASSED [ 74%]
tests/test_sensor.py::TestEvidenceSensor::test_extra_state_attributes_no_entity_manager PASSED [ 74%]
tests/test_sensor.py::TestDecaySensor::test_initialization PASSED        [ 74%]
tests/test_sensor.py::TestDecaySensor::test_native_value_property PASSED [ 74%]
tests/test_sensor.py::TestDecaySensor::test_extra_state_attributes PASSED [ 75%]
tests/test_sensor.py::TestDecaySensor::test_extra_state_attributes_no_entity_manager PASSED [ 75%]
tests/test_sensor.py::TestDecaySensor::test_extra_state_attributes_empty_entities PASSED [ 75%]
tests/test_sensor.py::TestAsyncSetupEntry::test_async_setup_entry_success PASSED [ 75%]
tests/test_sensor.py::TestAsyncSetupEntry::test_async_setup_entry_with_coordinator_data PASSED [ 76%]
tests/test_sensor.py::TestSensorIntegration::test_all_sensors_with_comprehensive_data PASSED [ 76%]
tests/test_sensor.py::TestSensorIntegration::test_sensor_availability_changes PASSED [ 76%]
tests/test_sensor.py::TestSensorIntegration::test_sensor_value_updates PASSED [ 76%]
tests/test_sensor.py::TestSensorIntegration::test_entities_sensor_dynamic_updates PASSED [ 76%]
tests/test_sensor.py::TestSensorIntegration::test_decay_sensor_dynamic_updates PASSED [ 77%]
tests/test_sensor.py::TestSensorIntegration::test_sensor_error_handling PASSED [ 77%]
tests/test_service.py::TestGetCoordinator::test_get_coordinator_success PASSED [ 77%]
tests/test_service.py::TestGetCoordinator::test_get_coordinator_missing_domain PASSED [ 77%]
tests/test_service.py::TestGetCoordinator::test_get_coordinator_missing_entry PASSED [ 78%]
tests/test_service.py::TestRunAnalysis::test_run_analysis_success PASSED [ 78%]
tests/test_service.py::TestRunAnalysis::test_run_analysis_missing_entry_id PASSED [ 78%]
tests/test_service.py::TestRunAnalysis::test_run_analysis_coordinator_error PASSED [ 78%]
tests/test_service.py::TestResetEntities::test_reset_entities_success PASSED [ 79%]
tests/test_service.py::TestResetEntities::test_reset_entities_missing_entry_id PASSED [ 79%]
tests/test_service.py::TestGetEntityMetrics::test_get_entity_metrics_success PASSED [ 79%]
tests/test_service.py::TestGetEntityMetrics::test_get_entity_metrics_missing_entry_id PASSED [ 79%]
tests/test_service.py::TestGetEntityMetrics::test_get_entity_metrics_coordinator_error PASSED [ 80%]
tests/test_service.py::TestGetProblematicEntities::test_get_problematic_entities_success PASSED [ 80%]
tests/test_service.py::TestGetProblematicEntities::test_get_problematic_entities_no_issues PASSED [ 80%]
tests/test_service.py::TestGetProblematicEntities::test_get_problematic_entities_coordinator_error PASSED [ 80%]
tests/test_service.py::TestGetEntityDetails::test_get_entity_details_success PASSED [ 80%]
tests/test_service.py::TestGetEntityDetails::test_get_entity_details_missing_entity_id PASSED [ 81%]
tests/test_service.py::TestGetEntityDetails::test_get_entity_details_entity_not_found PASSED [ 81%]
tests/test_service.py::TestGetAreaStatus::test_get_area_status_success PASSED [ 81%]
tests/test_service.py::TestGetAreaStatus::test_get_area_status_no_occupancy_state PASSED [ 81%]
tests/test_service.py::TestGetEntityTypeLearned::test_get_entity_type_learned_data_success PASSED [ 82%]
tests/test_service.py::TestGetEntityTypeLearned::test_get_entity_type_learned_data_coordinator_error PASSED [ 82%]
tests/test_service.py::TestAsyncSetupServices::test_async_setup_services_registration_error PASSED [ 82%]
tests/test_service.py::TestServiceIntegration::test_service_workflow_integration PASSED [ 82%]
tests/test_service.py::TestServiceIntegration::test_error_handling_across_services PASSED [ 83%]
tests/test_service.py::TestServiceIntegration::test_service_parameter_validation PASSED [ 83%]
tests/test_service.py::TestServiceIntegration::test_service_return_value_consistency PASSED [ 83%]
tests/test_state_mapping.py::TestStateOption::test_initialization PASSED [ 83%]
tests/test_state_mapping.py::TestStateOption::test_initialization_with_icon PASSED [ 84%]
tests/test_state_mapping.py::TestGetStateOptions::test_door_states PASSED [ 84%]
tests/test_state_mapping.py::TestGetStateOptions::test_window_states PASSED [ 84%]
tests/test_state_mapping.py::TestGetStateOptions::test_media_states PASSED [ 84%]
tests/test_state_mapping.py::TestGetStateOptions::test_appliance_states PASSED [ 84%]
tests/test_state_mapping.py::TestGetStateOptions::test_unknown_platform PASSED [ 85%]
tests/test_state_mapping.py::TestGetStateOptions::test_all_known_platforms PASSED [ 85%]
tests/test_state_mapping.py::TestGetFriendlyStateName::test_door_state_names PASSED [ 85%]
tests/test_state_mapping.py::TestGetFriendlyStateName::test_media_state_names PASSED [ 85%]
tests/test_state_mapping.py::TestGetFriendlyStateName::test_unknown_state PASSED [ 86%]
tests/test_state_mapping.py::TestGetFriendlyStateName::test_unknown_platform PASSED [ 86%]
tests/test_state_mapping.py::TestGetFriendlyStateName::test_case_sensitivity PASSED [ 86%]
tests/test_state_mapping.py::TestGetStateIcon::test_door_state_icons PASSED [ 86%]
tests/test_state_mapping.py::TestGetStateIcon::test_media_state_icons PASSED [ 87%]
tests/test_state_mapping.py::TestGetStateIcon::test_unknown_state_icon PASSED [ 87%]
tests/test_state_mapping.py::TestGetStateIcon::test_unknown_platform_icon PASSED [ 87%]
tests/test_state_mapping.py::TestGetStateIcon::test_icon_format PASSED   [ 87%]
tests/test_state_mapping.py::TestGetDefaultState::test_door_default PASSED [ 88%]
tests/test_state_mapping.py::TestGetDefaultState::test_window_default PASSED [ 88%]
tests/test_state_mapping.py::TestGetDefaultState::test_media_default PASSED [ 88%]
tests/test_state_mapping.py::TestGetDefaultState::test_appliance_default PASSED [ 88%]
tests/test_state_mapping.py::TestGetDefaultState::test_unknown_platform_default PASSED [ 88%]
tests/test_state_mapping.py::TestGetDefaultState::test_default_consistency PASSED [ 89%]
tests/test_state_mapping.py::TestStateMapping::test_mapping_completeness PASSED [ 89%]
tests/test_state_mapping.py::TestStateMapping::test_state_option_uniqueness PASSED [ 89%]
tests/test_state_mapping.py::TestStateMapping::test_state_option_names_exist PASSED [ 89%]
tests/test_state_mapping.py::TestStateMapping::test_return_type_consistency PASSED [ 90%]
tests/test_utils.py::TestValidateProb::test_valid_probabilities PASSED   [ 90%]
tests/test_utils.py::TestValidateProb::test_clamp_invalid_probabilities PASSED [ 90%]
tests/test_utils.py::TestValidateProb::test_type_conversion PASSED       [ 90%]
tests/test_utils.py::TestValidateProb::test_complex_numbers PASSED       [ 91%]
tests/test_utils.py::TestValidateProb::test_invalid_types PASSED         [ 91%]
tests/test_utils.py::TestValidatePrior::test_valid_priors PASSED         [ 91%]
tests/test_utils.py::TestValidatePrior::test_clamp_invalid_priors PASSED [ 91%]
tests/test_utils.py::TestValidateWeight::test_valid_weights PASSED       [ 92%]
tests/test_utils.py::TestValidateWeight::test_clamp_invalid_weights PASSED [ 92%]
tests/test_utils.py::TestValidateDecayFactor::test_valid_decay_factors PASSED [ 92%]
tests/test_utils.py::TestValidateDecayFactor::test_clamp_invalid_decay_factors PASSED [ 92%]
tests/test_utils.py::TestValidateDatetime::test_valid_datetime PASSED    [ 92%]
tests/test_utils.py::TestValidateDatetime::test_none_datetime PASSED     [ 93%]
tests/test_utils.py::TestFormatFloat::test_formatting PASSED             [ 93%]
tests/test_utils.py::TestFormatPercentage::test_percentage_formatting PASSED [ 93%]
tests/test_utils.py::TestBayesianProbability::test_active_state_calculation PASSED [ 93%]
tests/test_utils.py::TestBayesianProbability::test_inactive_state_calculation PASSED [ 94%]
tests/test_utils.py::TestBayesianProbability::test_edge_cases PASSED     [ 94%]
tests/test_utils.py::TestBayesianProbability::test_validation_of_inputs PASSED [ 94%]
tests/test_utils.py::TestBayesianProbability::test_bayesian_probability_fractional_weight PASSED [ 94%]
tests/test_utils.py::TestBayesianProbability::test_bayesian_probability_fractional_decay PASSED [ 95%]
tests/test_utils.py::TestBayesianProbability::test_none_evidence PASSED  [ 95%]
tests/test_utils.py::TestBayesianProbability::test_zero_decay_factor PASSED [ 95%]
tests/test_utils.py::TestComplementaryProbability::test_single_entity PASSED [ 95%]
tests/test_utils.py::TestComplementaryProbability::test_multiple_entities PASSED [ 96%]
tests/test_utils.py::TestComplementaryProbability::test_decaying_entity PASSED [ 96%]
tests/test_utils.py::TestComplementaryProbability::test_mixed_states PASSED [ 96%]
tests/test_utils.py::TestComplementaryProbability::test_many_low_weight_entities_do_not_exceed_prior PASSED [ 96%]
tests/test_utils.py::TestConditionalProbability::test_single_entity PASSED [ 96%]
tests/test_utils.py::TestConditionalProbability::test_multiple_entities PASSED [ 97%]
tests/test_utils.py::TestConditionalProbability::test_decaying_entity PASSED [ 97%]
tests/test_utils.py::TestConditionalSortedProbability::test_sorted_by_evidence_and_weight PASSED [ 97%]
tests/test_utils.py::TestTimeBasedPriorUtilities::test_datetime_to_time_slot PASSED [ 97%]
tests/test_utils.py::TestTimeBasedPriorUtilities::test_time_slot_to_datetime_range PASSED [ 98%]
tests/test_utils.py::TestTimeBasedPriorUtilities::test_time_slot_to_datetime_range_no_base_date PASSED [ 98%]
tests/test_utils.py::TestTimeBasedPriorUtilities::test_get_current_time_slot PASSED [ 98%]
tests/test_utils.py::TestTimeBasedPriorUtilities::test_get_time_slot_name PASSED [ 98%]
tests/test_utils.py::TestTimeBasedPriorUtilities::test_get_all_time_slots PASSED [ 99%]
tests/test_utils.py::TestAdditionalEdgeCases::test_validate_prob_complex_edge_cases PASSED [ 99%]
tests/test_utils.py::TestAdditionalEdgeCases::test_validate_datetime_edge_cases PASSED [ 99%]
tests/test_utils.py::TestAdditionalEdgeCases::test_bayesian_probability_extreme_values PASSED [ 99%]
tests/test_utils.py::TestAdditionalEdgeCases::test_time_slot_edge_cases PASSED [100%]

============================= 425 passed in 5.57s ==============================
